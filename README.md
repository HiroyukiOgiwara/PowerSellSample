# PowerShell Sample Scripts for Backup and OneDrive Sync

このリポジトリは、Avanade Japan 内部向けに作成された PowerShell ユーティリティ集です。  
主に以下の2つのスクリプトが含まれています。

- `backup_check.ps1`: フォルダ間のファイル整合性を確認するバックアップチェックツール
- `DiscCopy_CtoOneDrive.ps1`: Cドライブ内のフォルダを OneDrive に自動バックアップするコピー支援ツール

---

## 📁 スクリプト一覧

### 1. `backup_check.ps1`

`source` フォルダと `destination` フォルダを比較し、ファイル数・フォルダ数・サイズなどの整合性を確認します。

#### ✅ 主な機能

- ファイル数、フォルダ数、合計サイズの比較
- 差分があるファイルの一覧表示
- 引数を指定しない場合は対話形式でパスを入力
- `-help` スイッチで使用方法を表示可能

#### 🔧 パラメータ

| パラメータ名 | 説明                        |
|--------------|-----------------------------|
| `-source`     | 比較元フォルダのパス         |
| `-destination`| 比較先フォルダのパス         |
| `-help`       | 使い方を表示して終了するフラグ |

#### 💻 使用例

```powershell
.\backup_check.ps1 -source "C:\Work\プロジェクト" -destination "C:\Users\<ユーザー名>\OneDrive - Avanade\プロジェクト"
```
#### 📘 ヘルプ表示
```powershell
.\backup_check.ps1 -help
```
### 2. `DiscCopy_CtoOneDrive.ps1`
Cドライブ内の指定フォルダを OneDrive に自動バックアップするためのスクリプトです。
Cドライブ上のフォルダを OneDrive にバックアップコピーします。
主に業務用PCのディスク容量削減や安全な保管を目的としています。

#### ✅ 主な機能

- 対象フォルダ（デスクトップ、ドキュメント、ピクチャなど）を自動判定してコピー
- ローカルから OneDrive へ階層を維持して複製
- 同一ファイルはスキップして高速化
- リアルタイム進捗（1行）表示でスクロールなし視認性確保
- フォルダ/ファイル数、パーセンテージの動的更新
- `-help` スイッチで使用方法を表示可能

#### 🔧 パラメータ
| パラメータ名 | 説明                        |
|--------------|-----------------------------|
| `-help`       | 使い方を表示して終了するフラグ |
| `-source`     | コピー元のフォルダパス（デフォルトは C ドライブのユーザーフォルダ） |
| `-destination`| コピー先の OneDrive フォルダパス（デフォルトは OneDrive のルート） |

#### 💻 使用例
```powershell
.\DiscCopy_CtoOneDrive.ps1
```


#### 📤 出力例（画面）

```yaml
処理中・・・ 7491 ファイル 2853 フォルダ / 全 9734 ファイル 3650 フォルダ ： 77.29% 処理完了
```

#### 📘 ヘルプ表示
```powershell
.\DiscCopy_CtoOneDrive.ps1 -help
```

#### ⚠ 注意点

- OneDrive 側の空き容量が不足していると「赤い×」アイコンが表示され、同期が失敗します。
- ファイル名に使用できない文字（例：: * ? < > |）が含まれると同期できません。
- 同期エラーが発生した場合は、タスクバーの OneDrive アイコンを右クリック →「ヘルプと設定」→「同期の問題を表示」から詳細を確認してください。

#### 📌 注意事項
- 本スクリプトは Avanade 社内利用を目的としたものです。
- 運用環境で使用する前に、必ずテスト環境で動作確認してください。
- OneDrive の容量、Cドライブの空き容量、ファイル名の制限（全角スペース、記号など）に注意してください。

## 📜 ライセンス
このリポジトリのスクリプトは、Avanade Japan 内部での利用を目的としています。
商用利用や再配布はご遠慮ください。


